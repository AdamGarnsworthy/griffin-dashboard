<html>
    <head>
        <title>GRIFFIN MSC Builder</title>

        <!--libraries-->
        <script src='scripts/HTMLImports.min.js' type="text/javascript"></script>
        <script src='scripts/mustache.js' type="text/javascript"></script>
        <script src="scripts/jquery1-11-3.min.js" type="text/javascript"></script>
        <script src="scripts/kinetic-5.0.1.hackfix.js" type="text/javascript"></script>

        <!--helpers-->
        <script src='scripts/helpers.js' type="text/javascript"></script>
        <script src='scripts/dataStore.js' type="text/javascript"></script>
        <script src='scripts/heartbeat.js' type="text/javascript"></script>
        <script src='scripts/colorScales.js' type="text/javascript"></script>

        <!--style-->
        <link rel="stylesheet" href="css/global.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="scripts/bootstrap3-3-5.min.js" type="text/javascript"></script>
        <style>
            input[type=radio]{
                display:none;
            }

            div.section{
                background-color: #333333;
                padding: 0em 1em 1em 1em;
                border-radius: 1em;
                margin-bottom: 1em;
            }

            input[type=radio]:checked ~ label{
                background-color: #5cb85c;
                border-color: #4cae4c;
            }
        </style>

        <!--html imports-->
        <link id='brand-header' rel="import" href="templates/brand-header/brand-header.html">
        <link id='brand-footer' rel="import" href="templates/brand-footer/brand-footer.html">
    </head>

    <body>
        <div id='header'></div>

        <div class='section-wrapper'>
            <div class='col-md-8 col-md-offset-2 section'>
                <h2>Upstream Chamber</h2>
                <span>
                    <input id='USCabs' type='radio' name='USC' value='abs' checked></input>
                    <label id='USCabsLabel' for='USCabs' class='btn btn-info'>Absent</label>
                </span>
                <span>
                    <input id='USCsep' type='radio' name='USC' value='sep'></input>
                    <label id='USCsepLabel' for='USCsep' class='btn btn-info'>SCEPTAR</label>
                </span>
                <span>
                    <input id='USCpac' type='radio' name='USC' value='pac'></input>
                    <label id='USCpacLabel' for='USCpac' class='btn btn-info'>PACES</label>
                </span>
                <span>
                    <input id='USCspi' type='radio' name='USC' value='spi'></input>
                    <label id='USCspiLabel' for='USCspi' class='btn btn-info'>SPICE</label>
                </span>
            </div>

            <div class='col-md-8 col-md-offset-2 section'>
                <h2>Downstream Chamber</h2>
                <span>
                    <input id='DSCabs' type='radio' name='DSC' value='abs' checked></input>
                    <label id='DSCabsLabel' for='DSCabs' class='btn btn-info'>Absent</label>
                </span>
                <span>
                    <input id='DSCsep' type='radio' name='DSC' value='sep'></input>
                    <label id='DSCsepLabel' for='DSCsep' class='btn btn-info'>SCEPTAR</label>
                </span>
                <span>
                    <input id='DSCzds' type='radio' name='DSC' value='zds'></input>
                    <label id='DSCzdsLabel' for='DSCzds' class='btn btn-info'>ZDS</label>
                </span>
                <span>
                    <input id='DSCs2' type='radio' name='DSC' value='s2'></input>
                    <label id='DSCs2Label' for='DSCs2' class='btn btn-info'>S2</label>
                </span>
                <span>
                    <input id='DSCs3' type='radio' name='DSC' value='s3'></input>
                    <label id='DSCs3Label' for='DSCs3' class='btn btn-info'>S3</label>
                </span>
            </div>

            <div class='col-md-8 col-md-offset-2 section'>
                <h2>Corona</h2>
                <span>
                    <input id='CORabs' type='radio' name='COR' value='abs'></input>
                    <label id='CORabsLabel' for='CORabs' class='btn btn-info'>Absent</label>
                </span>
                <span>
                    <input id='CORgrg' type='radio' name='COR' value='grg' checked></input>
                    <label id='CORgrgLabel' for='CORgrg' class='btn btn-info'>GRIFFIN</label>
                </span>

                <table id='CORgriffin' class='table top-gutter'>
                    <tr>
                        <td>GRIFFIN Detectors</td>
                        <td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td>
                    </tr>
                    <tr>
                        <td>HPGe</td>
                        <td><input type='checkbox' id='grg5' checked></input></td>
                        <td><input type='checkbox' id='grg6' checked></input></td>
                        <td><input type='checkbox' id='grg7' checked></input></td>
                        <td><input type='checkbox' id='grg8' checked></input></td>
                        <td><input type='checkbox' id='grg9' checked></input></td>
                        <td><input type='checkbox' id='grg10' checked></input></td>
                        <td><input type='checkbox' id='grg11' checked></input></td>
                        <td><input type='checkbox' id='grg12' checked></input></td>
                    </tr>
                    <tr>
                        <td>Suppressors</td>
                        <td><input type='checkbox' id='grs5'></input></td>
                        <td><input type='checkbox' id='grs6'></input></td>
                        <td><input type='checkbox' id='grs7'></input></td>
                        <td><input type='checkbox' id='grs8'></input></td>
                        <td><input type='checkbox' id='grs9'></input></td>
                        <td><input type='checkbox' id='grs10'></input></td>
                        <td><input type='checkbox' id='grs11'></input></td>
                        <td><input type='checkbox' id='grs12'></input></td>
                    </tr>
                </table>
            </div>

            <div class='col-md-8 col-md-offset-2 section'>
                <h2>Upstream Lampshade</h2>
                <span>
                    <input id='USLabs' type='radio' name='USL' value='abs'></input>
                    <label id='USLabsLabel' for='USLabs' class='btn btn-info'>Absent</label>
                </span>
                <span>
                    <input id='USLgrg' type='radio' name='USL' value='grg' checked></input>
                    <label id='USLgrgLabel' for='USLgrg' class='btn btn-info'>GRIFFIN</label>
                </span>
                <span>
                    <input id='USLgrgdal' type='radio' name='USL' value='grgdal'></input>
                    <label id='USLgrgdalLabel' for='USLgrgdal' class='btn btn-info'>GRIFFIN + DANTE</label>
                </span>

                <table id='USLgriffin' class='table top-gutter'>
                    <tr>
                        <td>GRIFFIN Detectors</td>
                        <td>1</td><td>2</td><td>3</td><td>4</td>
                    </tr>
                    <tr>
                        <td>HPGe</td>
                        <td><input type='checkbox' id='grg13' checked></input></td>
                        <td><input type='checkbox' id='grg14' checked></input></td>
                        <td><input type='checkbox' id='grg15' checked></input></td>
                        <td><input type='checkbox' id='grg16' checked></input></td>
                    </tr>
                    <tr>
                        <td>Suppressors</td>
                        <td><input type='checkbox' id='grs13'></input></td>
                        <td><input type='checkbox' id='grs14'></input></td>
                        <td><input type='checkbox' id='grs15'></input></td>
                        <td><input type='checkbox' id='grs16'></input></td>
                    </tr>
                </table>
            </div>

            <div class='col-md-8 col-md-offset-2 section'>
                <h2>Downstream Lampshade</h2>
                <span>
                    <input id='DSLabs' type='radio' name='DSL' value='abs'></input>
                    <label id='DSLabsLabel' for='DSLabs' class='btn btn-info'>Absent</label>
                </span>
                <span>
                    <input id='DSLgrg' type='radio' name='DSL' value='grg' checked></input>
                    <label id='DSLgrgLabel' for='DSLgrg' class='btn btn-info'>GRIFFIN</label>
                </span>
                <span>
                    <input id='DSLgrgdal' type='radio' name='DSL' value='grgdal'></input>
                    <label id='DSLgrgdalLabel' for='DSLgrgdal' class='btn btn-info'>GRIFFIN + DANTE</label>
                </span>
                <span>
                    <input id='DSLdsc' type='radio' name='DSL' value='dsc'></input>
                    <label id='DSLdscLabel' for='DSLdsc' class='btn btn-info'>DESCANT</label>
                </span>

                <table id='DSLgriffin' class='table top-gutter'>
                    <tr>
                        <td>GRIFFIN Detectors</td>
                        <td>1</td><td>2</td><td>3</td><td>4</td>
                    </tr>
                    <tr>
                        <td>HPGe</td>
                        <td><input type='checkbox' id='grg1' checked></input></td>
                        <td><input type='checkbox' id='grg2' checked></input></td>
                        <td><input type='checkbox' id='grg3' checked></input></td>
                        <td><input type='checkbox' id='grg4' checked></input></td>
                    </tr>
                    <tr>
                        <td>Suppressors</td>
                        <td><input type='checkbox' id='grs1'></input></td>
                        <td><input type='checkbox' id='grs2'></input></td>
                        <td><input type='checkbox' id='grs3'></input></td>
                        <td><input type='checkbox' id='grs4'></input></td>
                    </tr>
                </table>
            </div>
            
        </div>

        <div id='footer'></div>

        <script>

            window.addEventListener('HTMLImportsLoaded', function(e) {

                var i, templates, detectorToggles;

                ///////////////////////////
                //handle templates
                ///////////////////////////
                templates = ['brand-header', 'brand-footer'];
                dataStore.templates = prepareTemplates(templates);

                //inject templates
                //header
                document.getElementById('header').innerHTML = Mustache.to_html(
                    dataStore.templates['brand-header'], 
                    {
                        'title': 'GRIFFIN MSC Builder',
                    }
                );
                //footer
                document.getElementById('footer').innerHTML = Mustache.to_html(
                    dataStore.templates['brand-footer'], 
                    {
                        
                    }
                );
                setupFooter('footerImage', 2, '#999999');

                //plug in detector toggles
                detectorToggles = document.querySelectorAll('input[type=radio]');
                for(i=0; i<detectorToggles.length; i++){
                    detectorToggles[i].onchange = manageState
                }

                manageState();

            });

            function manageState(){
                // manage which detectors can be selected with which other detectors etc

                var DSC = document.querySelector('input[name="DSC"]:checked').value,
                    USC = document.querySelector('input[name="USC"]:checked').value,
                    COR = document.querySelector('input[name="COR"]:checked').value,
                    DSL = document.querySelector('input[name="DSL"]:checked').value,
                    USL = document.querySelector('input[name="USL"]:checked').value,
                    labels, inactiveLabels, i;


                // spice (and ony spice) in the USC pairs with s2 / s3 in the DSC
                // also spice services occupy the upstream lampshade position
                if(USC == 'spi'){
                    document.getElementById('DSCsepLabel').classList.add('disabled');
                    document.getElementById('DSCzdsLabel').classList.add('disabled');
                    document.getElementById('DSCs2Label').classList.remove('disabled');
                    document.getElementById('DSCs3Label').classList.remove('disabled');
                    if(DSC == 'sep' || DSC == 'zds')
                        document.getElementById('DSCabs').click();

                    document.getElementById('USLgrgLabel').classList.add('disabled');
                    document.getElementById('USLgrgdalLabel').classList.add('disabled');
                    if(USL != 'abs'){
                        document.getElementById('USLabs').click();
                        USL = 'abs'
                    }
                } else {
                    document.getElementById('DSCsepLabel').classList.remove('disabled');
                    document.getElementById('DSCzdsLabel').classList.remove('disabled');
                    document.getElementById('DSCs2Label').classList.add('disabled');
                    document.getElementById('DSCs3Label').classList.add('disabled');
                    if(DSC == 's2' || DSC == 's3')
                        document.getElementById('DSCabs').click();

                    document.getElementById('USLgrgLabel').classList.remove('disabled');
                    document.getElementById('USLgrgdalLabel').classList.remove('disabled');
                }

                // show griffin position options iff griffin is selected
                if(COR == 'grg')
                    document.getElementById('CORgriffin').classList.remove('hidden');
                else
                    document.getElementById('CORgriffin').classList.add('hidden');

                if(USL == 'grg' || USL =='grgdal')
                    document.getElementById('USLgriffin').classList.remove('hidden');
                else
                    document.getElementById('USLgriffin').classList.add('hidden')

                if(DSL == 'grg' || DSL =='grgdal')
                    document.getElementById('DSLgriffin').classList.remove('hidden');
                else
                    document.getElementById('DSLgriffin').classList.add('hidden')

                // manage clickability of labels
                labels = document.querySelectorAll('label');
                for(i=0; i<labels.length; i++)
                    labels[i].onclick = function(){return true;}
                inactiveLabels = document.querySelectorAll('label.disabled');
                for(i=0; i<inactiveLabels.length; i++){
                    inactiveLabels[i].onclick = function(e){
                        e.preventDefault();
                        e.stopPropagation();
                        return false;
                    }
                }
            }
        </script>

    </body>
</html>