<html>
    <head>
        <title>GRIFFIN Detector</title>

        <!--libraries-->
        <script src='scripts/HTMLImports.min.js' type="text/javascript"></script>
        <script src='scripts/mustache.js' type="text/javascript"></script>
        <script src="scripts/jquery1-11-3.min.js" type="text/javascript"></script>

        <!--helpers-->
        <script src='scripts/dataStore.js' type="text/javascript"></script>
        <script src='scripts/helpers.js' type="text/javascript"></script>
        <script src='scripts/heartbeat.js' type="text/javascript"></script>
        <script src='scripts/data-callbacks.js' type="text/javascript"></script>

        <!--style-->
        <link rel="stylesheet" href="css/global.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="scripts/bootstrap3-3-5.min.js" type="text/javascript"></script>

        <!--html imports-->
        <link id='brand-header' rel="import" href="templates/brand-header/brand-header.html">
        <link id='run-status' rel="import" href="templates/run-status/run-status.html">
    </head>

    <body>
        <div id='header'></div>

        <div class='sectionWrapper'>
            <div id='runStat' class='col-md-2'></div>
        </div>

        <script>
            window.addEventListener('HTMLImportsLoaded', function(e) {
                //prep templates
                templates = ['brand-header', 'run-status'];
                dataStore.templates = prepareTemplates(templates);

                //inject templates
                document.getElementById('header').innerHTML = Mustache.to_html(
                    dataStore.templates['brand-header'], 
                    {
                        'title': 'GRIFFIN Detector Status',
                    }
                );

                document.getElementById('runStat').innerHTML = Mustache.to_html(
                    dataStore.templates['run-status'], 
                    {

                    }
                );

                //post-heartbeat callback:
                function dataUpdate(){
                    updateRunStatus();
                }

                //initiate heartbeat
                heartbeat([], [dataStore.runSummaryQuery], dataUpdate)
            });
        </script>

    </body>
</html>